{{ define "main" }}
<section class="section">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-lg-10">
        <link href="/pagefind/pagefind-ui.css" rel="stylesheet">
        <script src="/pagefind/pagefind-ui.js"></script>
        
        <h1 style="margin-bottom: 2rem;">ç«™å…§æœå°‹</h1>
        <div id="search"></div>

        <script>
          window.addEventListener('DOMContentLoaded', function() {
            // åˆå§‹åŒ– Pagefind UI
            const pf = new PagefindUI({
              element: "#search",
              showImages: true,        // å•Ÿå‹•ç¸®åœ–é¡¯ç¤º
              openFilters: false,      // é è¨­æŠ˜ç–Šéæ¿¾é¢æ¿
              resetStyles: false,
              excerptLength: 30,       // æ‘˜è¦é•·åº¦ç¨å¾®å¢åŠ 
              
              // 1. ä¸­æ–‡åŒ–è¨­å®š
              translations: {
                placeholder: "è¼¸å…¥é—œéµå­—æœå°‹...",
                zero_results: "æ‰¾ä¸åˆ°ç›¸é—œå…§å®¹ ğŸ˜”",
                loading: "æœå°‹ä¸­...",
                search_button: "æœå°‹",
                clear_button: "æ¸…é™¤"
              },

              // 2. è‡ªå‹•ä¿®æ­£ç¸®åœ–è·¯å¾‘ï¼ˆé¿å…åœ–ç‰‡ç ´åœ–ï¼‰
              processResult: function (result) {
                if (result.meta.image && !result.meta.image.startsWith('http')) {
                  // è‡ªå‹•è£œå…¨ç¶²ç«™ç¶²å€ï¼Œç¢ºä¿ç¸®åœ–é¡¯ç¤ºæ­£å¸¸
                  result.meta.image = window.location.origin + result.meta.image;
                }
                return result;
              }
            });
          });

          // 3. é»æ“Šçµæœåœ¨æ–°åˆ†é é–‹å•Ÿ
          document.addEventListener('click', function(e) {
            const link = e.target.closest('.pagefind-ui__result-link');
            if (link) {
              e.preventDefault();
              window.open(link.href, '_blank');
            }
          });
        </script>
      </div>
    </div>
  </div>
</section>
{{ end }}