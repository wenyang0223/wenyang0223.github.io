{{/* 1. 清理路徑並嘗試取得圖片資源 */}}
{{- $src := strings.TrimPrefix "/" .Destination -}}
{{- $img := resources.Get $src -}}

<div class="image-aspect-ratio-container">
  {{- if $img -}}
    {{/* 2. 成功抓到圖：自動生成 WebP */}}
    {{- $webp := $img.Resize (printf "%dx%d webp" $img.Width $img.Height) -}}
    <picture>
      <source srcset="{{ $webp.RelPermalink }}" type="image/webp">
      {{/* 這裡保留你原本的 class 和 lazy loading */}}
      <img src="{{ $img.RelPermalink }}" 
           alt="{{ .Text }}" 
           title="{{ .Title }}" 
           loading="lazy" 
           class="unified-post-img">
    </picture>
  {{- else -}}
    {{/* 3. 如果在 assets 找不到（可能還在 static），就用原始路徑顯示 */}}
    <img src="{{ .Destination | safeURL }}" 
         alt="{{ .Text }}" 
         title="{{ .Title }}" 
         loading="lazy" 
         class="unified-post-img">
  {{- end -}}
</div>

{{/* 4. 這裡可以保留你的 CSS 樣式 */}}

<style>
  /* 這裡控制圖片的外框比例 */
  .image-aspect-ratio-container {
    width: 100%;
    max-width: 800px;  /* 你可以設定最大寬度 */
    margin: 1.5rem auto;
    overflow: hidden;
    border-radius: 8px; /* 圓角（選配） */
  }

  .unified-post-img {
    width: 100%;
    height: 450px;     /* 強制所有圖片高度統一 */
    object-fit: cover; /* 關鍵：裁切中心，不壓扁圖片 */
    object-position: center;
    display: block;
  }

  /* 手機版自動縮小高度，避免太佔空間 */
  @media (max-width: 768px) {
    .unified-post-img {
      height: 250px;
    }
  }
</style>